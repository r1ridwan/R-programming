library(minfi)
library(GEOquery)

#Package Name: minfi
#Description: Analyze Illumina Infinium DNA methylation arrays
#Bioconductor URL: http://bioconductor.org/packages/release/bioc/html/minfi.html
#Documentation URL: http://bioconductor.org/packages/release/bioc/vignettes/minfi/inst/doc/minfi.html

## ----geoquery------------------------------------------------------------
library(GEOquery)
getGEOSuppFiles("GSE68777")
untar("GSE68777/GSE68777_RAW.tar", exdir = "GSE68777/idat")
head(list.files("GSE68777/idat", pattern = "idat"))

## ----decompress----------------------------------------------------------
idatFiles <- list.files("GSE68777/idat", pattern = "idat.gz$", full = TRUE)
sapply(idatFiles, gunzip, overwrite = TRUE)

## ----readExp-------------------------------------------------------------
rgSet <- read.450k.exp("GSE68777/idat")
rgSet
pData(rgSet)
head(sampleNames(rgSet))

## ----geoPheno------------------------------------------------------------
geoMat <- getGEO("GSE68777")
pD.all <- pData(geoMat[[1]])
pD <- pD.all[, c("title", "geo_accession", "characteristics_ch1.1", "characteristics_ch1.2")]
head(pD)
names(pD)[c(3,4)] <- c("group", "sex")
pD$group <- sub("^diagnosis: ", "", pD$group)
pD$sex <- sub("^Sex: ", "", pD$sex)

## ----merge---------------------------------------------------------------
sampleNames(rgSet) <- sub(".*_5", "5", sampleNames(rgSet))
rownames(pD) <- pD$title
pD <- pD[sampleNames(rgSet),]
pData(rgSet) <- pD
rgSet

## ----preprocess----------------------------------------------------------
grSet <- preprocessQuantile(rgSet)
grSet

## ----granges-------------------------------------------------------------
granges(grSet)

## ----getBeta-------------------------------------------------------------
getBeta(grSet)[1:3,1:3]

## ----getIslandStatus-----------------------------------------------------
head(getIslandStatus(grSet))

## ----sessionInfo, echo=FALSE---------------------------------------------
sessionInfo()

